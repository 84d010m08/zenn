---
title: "クリーンアーキテクチャについて考える　自動生成編"
emoji: "🕌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["CleanArchitecture", "Golang", "dig", "jennifer", "echo"]
published: false
---

## 目的

フレームワークにEchoを使いながら、クリーンアーキテクチャの実現を簡易的に目指すためにdigを使った依存性逆転まで実現させる方法まで考えた。しかし、単純に開発者が守るべきルールとしては決まった作業が多く感じる。
そこで、Golangには自動生成する文化があるのでデフォルトの部分は自動生成して開発者が実装部分に注力しやすい環境を用意する。

## 実現に向けて

今回はあくまでも自動生成にのみできることを目指す。作成済みのファイルをコマンド１つで修正できるといったことは目指さない。

自動生成は[Jennifer](https://github.com/dave/jennifer)を使います。
また、作成にあたりdigの取りまわしも考えます。なぜ考えるのかは自動生成で作成したあとの取りまわしをよくするためです。詳細は後述させていただきます。

## Jennifer

### 採用の経緯

JenniferはGolangのための自動生成モジュールになります。
そもそもGolangにはgo generateという自動生成コマンドが存在しています。
生成コードの管理が大変そうな印象を受けて、避けてJenniferを見つけてきました。
また、今回自動生成で補いたかった内容がInterfaceとその注入先の関係を一定にしたかったという点です。詳細に箇条書きすると

- 注入関数はNewから始めたい。
- Interfaceはインターフェイスとわかる名称をつけないが、注入するほうは末尾にImpをつけたい
- Interfaceと注入側は別のフォルダにしたい

の3点です。
Jenniferならこの3点に関してそれほど複雑な対応が求められていないので実装が大変ではありませんでした。ただ、生成される内容がコードを読まなければいけないという点に関してはデメリットではあります。ですが、生成されるコードが単純なものなので大きなマイナスではないとう認識で採用に至っています。

### 使ってみる

試してみるステージにはあるモジュールではあるので実際に使ってみました。






## 今考えている構成に組み込む

## 統括
